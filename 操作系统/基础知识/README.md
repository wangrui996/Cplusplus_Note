# 操作系统基础知识  

**操作系统**：计算机硬件和应用之间的一层软件  

**管理**：CPU管理 内存管理  终端管理  磁盘管理  文件管理  网络  ...   


## 汇编基础  

mov
int  


## 操作系统的启动  

* 1.上电后先执行内存中固化的汇编程序段，执行的是内存中BIOS映射区代码，主要进行主板、显示器、键盘等检查，并将磁盘0磁道0扇区（512个字节的引导扇区）读入内存的某个地址处  
* 2.磁盘的引导扇区（boot扇区）是启动设备的第一个扇区，也可以认为是操作系统的第一部分（boot扇区）
    * 引导扇区代码：bootsect.s  
        2.1 将bootsect.s代码段向后移动，腾出钱买呢的一段空间（后面可以发现放的是system的代码，最后汇编会有个读磁盘的中断，会将磁盘的第2个扇区开始读，读4个扇区，这部分是setup的四个扇区，读到内存中bootsect后面的位置
        2.2 其中一个功能是将某字符串输出到显示器光标位置  
        2.3 读入system模块  
        2.4 bootsect结束后，需要执行setup，用jmpi命令，修改CS IP位置  
* 3.setup模块
    3.1 读入物理内存大小(要管理内存必须的操作，比如分页？)
    3.2 将system模块移到0地址
    **3.3 进入保护模式：也就是将原来的实模式寻址方式修改为32寻址，具体操作是通过修改cr0寄存器最低位为1，即进入保护模式（就会走另外一条解释执行指令的电路）*  
    **保护模式下的地址翻译和中断处理：gdt（硬件实现了，软件也可以做但硬件实现后速度会快） 此时CS不再是地址，而是选择子，即查表的索引，从表中查到真正的基地址后+ip偏移产生最后的地址  这套方案实现的基础就是要有一个表，gdt表（t table）——所以setup还要做的一件事是产生这个表，设置保护模式下的中断和寻址**   
    保护模式下：寻址的CS是需要从表中查到地址，中断的汇编代码int n也是去表中查，找到的是中断函数的入口地址  


**注意：**  
一开始的寻址方式（实模式）CS:IP(CS左移4位+IP)  
保护模式下寻址方式：32位寻址  

setup最后就需要把寻址方式转换，因为实模式下的方式，CS和IP是16位地址，CS左移4位也才32位地址，支持的内存寻址范围是很小的，而我们的内存通常4G，完全不够
