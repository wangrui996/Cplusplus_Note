# 可靠数据传输原理  

## 可靠  

* 不错 如分组在传输过程中有一位发生了错误，需要纠正过来
* 不丢 分组传输过程中发生了丢失
* 不乱 分组顺序不能乱  

## 可靠数据传输协议  

* 可靠数据传输对应用层、传输层、链路层都很重要  
* 网络Top-10问题  
* 信道的不可靠特性决定了可靠数据传输协议(rdt)的复杂性  


## 可靠数据传输协议(rdt)基本结构 ： 接口  

![image](https://user-images.githubusercontent.com/58176267/158301002-abfde68d-1730-4d6f-b110-5b3d7e5000a3.png)


rdt_send(): 被上层网络应用调用，将数据将给rdt以发送给对方  

udt_send(): 被rdt调用，在不可靠信道上向接收方传输数据 在Iternet上，这里的unreliable channel就是IP  

rdt_rcv() : 当分组到达接收方信道时被调用  

deliver_data() : 被接收方rdt调用，向上层应用交付数据  


### 注意：  
* 1. rdt_send()被应用单向调用一次， deliver_data() 是接收方rdt单向调用一次，  **也就是对于应用层来说，发送方应用只管把数据交给rdt剩下的就不管了，接收方应用只接收rdt处理好的数据，其余的事情不管**   
* 2. **rdt和不可靠信道之间的调用都是双向的**   


## rdt  

* 渐进地设计可靠数据传输协议的发送方和接收方
* 只考虑**单向数据传输**  
    * **但控制信息双向流动**   
* 利用状态机(Finite State Machine， FSM)刻画传输协议   

### 有限状态自动机  

![image](https://user-images.githubusercontent.com/58176267/158303554-938e93e1-407f-4cd5-8810-776f693afee8.png)


* 每一个圆圈表示一个状态
* 圆圈之间的箭头表示状态的变迁  
* 箭头上方  红线上面表示引起状态变迁的事件  红线下方表示状态转换过程中要采取的动作    
* 状态必须唯一确定  状态之间的变迁必须要明确，不能一个事件引起状态1既向状态2变迁又向状态3变迁  



## rdt1.0  可靠信道上的可靠数据传输  

* 底层信道完全可靠  
    * 不会发生错误(bit error) 
    * 不会丢失分组，乱序  
* 发送方和接收方的FSM独立 



* 由于发送方和接收方之间的信道是完全可靠的，发送方确信数据正确发送到接收方  两者之间不需要其他信息的交互 也就是不需要控制信息  因此发送方接收方状态相互独立  

 ### 发送方 有限状态自动机 FSM刻画  
 
 **只有一个圆圈表示只有一个状态————等待上层应用调用**  
 
当发生调用事件时(rdt_send(data)) , 要采取一些活动：packet = make_pkt(data)创建一些分组  udt_send(packet)通过下层信道将分组发出去  由于确信分组会正确无误的发送到接收方所以不需要做其他的了，就 **“继续回到等待上层调用的状态”**
 
 
 ### 接收方 状态机  
 
 * 一个状态：等待下层的调用(rdt_rev(packet)这个事件)、
 * 等有这个事件发生时，进行活动： 从分组中提取数据，并交付给上层应用  (因为确信分组正确) 
 * 活动完后，继续回到等待接收下层调用的状态  
 
 
 
 




